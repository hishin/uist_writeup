\section{Algorithmic Methods}
\label{sec:algorithms}
Our authoring interface relies on audio transcription and text alignment algorithms to link the master-script to the audio recordings.  

\subsection{Transcribing the audio recording}
We use IBM Speech to Text Service \cite{ibmspeechtotext} to obtain a verbatim transcript of each audio recording in real-time. The service outputs a time stamp for each word indicating its start and end time within the audio. It also segments the transcript into \textit{utterances} where each utterance is separated by a longer silent gap in the speech (longer than 500 ms). While automatic speech recognition is imperfect, we have found that the results were accurate enough for the purpose of alignment (below) and for users to understand the transcript. Users can also have the option of correcting transcription errors without altering the underlying audio.
  
\subsection{Aligning the transcript to the master-script}
Once we have a verbatim transcript of an audio take, we compute the global word-to-word alignment between the transcript and the master script using the Needleman-Wunsch (NW) algorithm \cite{needleman1970general}. NW allows for insertions and deletions, which accounts for differences in the two texts for example, due to loose scripts, or inaccurate speech or transcription. We use the global alignment results to compute a co-segmentation of the two texts.

In order to display corresponding parts in the master-script and the transcript side-by-side, we need to partition the texts into comparable segments. For example, text differencing and merging tools usually treat each line of text as a single segment.
Ideally, our segments would respect natural boundaries such as sentence punctuations, line breaks and pauses in the audio. We would also like to separate parts of the transcript that agrees with the master-script (i.e. planned speech) from parts that do not (i.e. improvised speech).  
We designed a scoring function that optimizes for these requirements and use an iterative algorithm to co-segment the two texts. We first explain the algorithm and then describe the scoring function in detail.

\textbf{Iterative co-segmentation}
The segmentation of the master-script depends on the segmentation of the transcript and vice versa. We propose an iterative approach, where the algorithm alternates between optimally segmenting the master-script and the transcript independently using the result from one to segment the other. We initialize the segment boundaries at punctuations [.!?:;] in the unrecorded text and longer silent gaps ($>$\ 500ms)\ in the recorded text. In practice, we
found that two iterations were sufficient to converge to a solution.


For each optimization step, we use the classic optimal line-breaking algorithm by Knuth and Plass \cite{}. Given the text as a sequence of $n$ words $T = \{w_0,\dots,w_n\}$, the algorithm finds the optimal set of inter-word
boundaries that break the text into segments. We refer to the boundary between $w_i$ and $w_{i+1}$ as
$b_i$.
%
The algorithm iterates through each word, and for each $w_i$
computes and records the optimal set of text segments $S_i$ for words up to $b_i$, along with the total score $E(S_i)$ of
this partial solution. To determine the optimal partial solution for $w_i$, it
considers each previous boundary $b_j$ $(j<i)$, and evaluates two possible ways of
segmenting the text $T_{ji} = \{w_\text{j+1},
\dots,w_\text{i}\}$: 1) appending $T_{ji}$ to the last segment in $S_j$, or 2) forming a new text segment with $T_{ji}$. The algorithm selects the better (lower) of the two scores for $T_{ji}$ and add it
to $E(S_j)$ to obtain the total score for the proposed
segmentation. After considering all candidate boundaries $b_j$, the partial solution with the minimum segmentation score is taken. Once the algorithm iterates through all the words, $S_n$ gives the
optimal set of segments for the entire text. 

\textbf{Scoring function}
The dynamic programming algorithm described above requires a
scoring function that evaluates the goodness of candidate text segments. We define this scoring function
based on three terms: 
\begin{enumerate}
\item{\textit{Punctuation and silent gaps}: \VTODO{Segment boundaries at periods, pauses. Helps joining audio seamlessly.} }
\item{\textit{Global alignment}: \VTODO{In global alignment computed with NW, some words don't have match, some do. We use this info to separate improvised vs planned.}}
\item{\textit{Consistency with the other text}: \VTODO{Since the end goal is to align the two texts, segments from each text should coincide.}} 
\end{enumerate}




